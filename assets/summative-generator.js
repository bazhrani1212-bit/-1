/* assets/summative-generator.js
   ููููุฏ ุฐูู: ูุทุงุจู ุนููุงู ุงูุฏุฑุณ ุจูููุงุช ููุชุงุญูุฉ ูููููุฏ ุงุฎุชุจุงุฑูุง ููุงุณุจูุง.
   ุฃููุงุน ุงูุฃุณุฆูุฉ: MCQ + TF + Short(HOTS) + ุชุบุฐูุฉ ุฑุงุฌุนุฉ + ุฑููุฒ.
*/

window.SUMMATIVE_GEN = (() => {

  const skillEmoji = {
    "ุชุฐูุฑ":"๐ง", "ููู":"๐ก", "ุชุทุจูู":"๐งช", "ุชุญููู":"๐", "ุชูููู":"โ๏ธ", "ุฅุจุฏุงุน":"๐ฏ"
  };

  const normalize = (s) => String(s||"")
    .toLowerCase()
    .replaceAll("ุฃ","ุง").replaceAll("ุฅ","ุง").replaceAll("ุข","ุง")
    .replaceAll("ุฉ","ู").replaceAll("ู","ู")
    .trim();

  const hasAny = (title, keys) => keys.some(k => normalize(title).includes(normalize(k)));

  function mcq(skill, prompt, options, correct, fc, fw){
    return {
      type:"mcq",
      skill,
      prompt,
      options,
      correct,
      feedbackCorrect: fc || "ุฃุญุณูุชู โ๐",
      feedbackWrong: fw || "ุฑุงุฌุนู ุงูููุฑุฉ ๐๐"
    };
  }
  function tf(skill, prompt, correctTF, fc, fw){
    return {
      type:"tf",
      skill,
      prompt,
      correctTF: !!correctTF,
      feedbackCorrect: fc || "ุตุญูุญ โ๐",
      feedbackWrong: fw || "ุบูุฑ ุตุญูุญ โ๐ก"
    };
  }
  function shortQ(skill, prompt, keywords, fc, fw){
    return {
      type:"short",
      skill,
      prompt,
      keywords: Array.isArray(keywords) ? keywords : [],
      feedbackCorrect: fc || "ุฅุฌุงุจุฉ ููููุฉ ๐ฏโ",
      feedbackWrong: fw || "ุญุงููู ุฐูุฑ ููุงููู ุฃุณุงุณูุฉ ๐"
    };
  }

  // ======= ุจููู ููุถูุนูุฉ =======
  function bankSpace(lessonTitle){
    return [
      mcq("ููู", `ุฃู ุนุจุงุฑุฉ ุชูุณูุฑ ุธุงูุฑุฉ ูุฑุชุจุทุฉ ุจุฏุฑุณ (${lessonTitle})ุ`,
        ["ุงุตุทูุงู ุงูุฃุฌุฑุงู ูุฏ ูุณุจุจ ูุณูููุง/ุฎุณูููุง", "ุงูููุฑ ูุตุฏุฑ ุถูุกูุง ูู ููุณู", "ุงููุฌูู ุฃูุฑุจ ูู ุงูููุฑ ููุฃุฑุถ", "ุชุญุฏุซ ุงูุฃุทูุงุฑ ุจุณุจุจ ุชุบูุฑ ุญุฌู ุงูููุฑ"],
        0,
        "ููุชุงุฒ! โ๐", "ุฑุงุฌุนู ููููู ุงูุนูุงุณ ุงูุถูุก ูุงูุงุตุทูุงู ๐"),
      mcq("ุชุทุจูู", "ุฃู ุชุฑุชูุจ ุตุญูุญ ูุญุฏูุซ ูุณูู ุงูุดูุณุ",
        ["ุงูุดูุณ โ ุงูููุฑ โ ุงูุฃุฑุถ", "ุงูุดูุณ โ ุงูุฃุฑุถ โ ุงูููุฑ", "ุงูุฃุฑุถ โ ุงูููุฑ โ ุงูุดูุณ", "ุงูููุฑ โ ุงูุดูุณ โ ุงูุฃุฑุถ"],
        0,
        "ุฃุญุณูุชู! ๐โ๏ธโ", "ุชุฐูุฑู: ุงูููุฑ ุจูู ุงูุดูุณ ูุงูุฃุฑุถ ๐"),
      tf("ููู", "ุตุญ/ุฎุทุฃ: ุฃุทูุงุฑ ุงูููุฑ ุชูุชุฌ ูุฃููุง ูุฑู ุฃุฌุฒุงุก ูุฎุชููุฉ ูู ุงูุฌุฒุก ุงููุถูุก ููู.", true,
        "ุตุญูุญ โ๐", "ุฑุงุฌุนู ููุฑุฉ ุงูุนูุงุณ ุถูุก ุงูุดูุณ ๐"),
      tf("ุชุทุจูู", "ุตุญ/ุฎุทุฃ: ูุญุฏุซ ุฎุณูู ุงูููุฑ ุนูุฏูุง ูููู ุงูููุฑ ุจูู ุงูุดูุณ ูุงูุฃุฑุถ.", false,
        "ููุชุงุฒ โ", "ุฎุณูู ุงูููุฑ: ุงูุฃุฑุถ ุชููู ุจูู ุงูุดูุณ ูุงูููุฑ ๐"),
      shortQ("ุชุญููู", `ูุณูุฑู ููุงุฐุง ูุง ูุญุฏุซ ุงููุณูู ูุงูุฎุณูู ูู ูู ุดูุฑ ููุฑู. (${lessonTitle})`,
        ["ูุฏุงุฑ", "ูุงุฆู", "ุงุตุทูุงู"],
        "ุฅุฌุงุจุฉ ุฑุงุฆุนุฉ ๐ฏ", "ุงุฐูุฑู (ููู ุงููุฏุงุฑ/ุนุฏู ุงูุงุตุทูุงู) ๐"),
      shortQ("ุฅุจุฏุงุน", `ุงุจุชูุฑู ูููุฐุฌูุง ุจุณูุทูุง ููุถุญ ููููู ุงูุฏุฑุณ (${lessonTitle}) ุจุงุณุชุฎุฏุงู ูุตุจุงุญ ููุฑุชูู.`,
        ["ูุตุจุงุญ", "ูุฑุฉ", "ุธู", "ุงุตุทูุงู"],
        "ูุจุฏุนุฉ! ๐", "ุญุงููู ุฐูุฑ ุฃุฏูุงุช ูุฎุทูุงุช ูุงุถุญุฉ ๐")
    ];
  }

  function bankElectricity(lessonTitle){
    return [
      mcq("ููู", `ุฃู ููุง ููู ูุตู ุฏุงุฆุฑุฉ ููุฑุจุงุฆูุฉ ูุบููุฉุ (${lessonTitle})`,
        ["ูุณุงุฑ ููุชูู ููุฑ ููู ุงูุชูุงุฑ", "ุณูู ููุทูุน", "ุจุทุงุฑูุฉ ุจุฏูู ุฃุณูุงู", "ูุตุจุงุญ ุจุฏูู ูุตุฏุฑ ุทุงูุฉ"],
        0,
        "ุตุญูุญ โ๐ก", "ุชุฐูุฑู: (ูุณุงุฑ ููุชูู) ๐"),
      mcq("ุชุทุจูู", "ุฃู ุฅุฌุฑุงุก ูุฒูุฏ ุณุทูุน ุงููุตุจุงุญ ุนุงุฏุฉู ูู ูููุฐุฌ ุจุณูุทุ",
        ["ุฒูุงุฏุฉ ูุตุฏุฑ ุงูุทุงูุฉ (ูุซู ุฅุถุงูุฉ ุจุทุงุฑูุฉ)", "ูุทุน ุฃุญุฏ ุงูุฃุณูุงู", "ุฅุฒุงูุฉ ุงููุตุจุงุญ", "ูุชุญ ุงูููุชุงุญ"],
        0,
        "ุฃุญุณูุชู โ๐", "ุฑุงุฌุนู ููููู ุงูุฏุงุฆุฑุฉ ุงููุบููุฉ/ุงููุตุฏุฑ ๐"),
      tf("ููู", "ุตุญ/ุฎุทุฃ: ุงูููุชุงุญ ุงูููุฑุจุงุฆู ูุณุงุนุฏ ุนูู ูุชุญ ูุฅุบูุงู ุงูุฏุงุฆุฑุฉ.", true,
        "ุตุญูุญ โ๐", "ุงูููุชุงุญ ููุชุญูู ูู ูุฑูุฑ ุงูุชูุงุฑ ๐"),
      tf("ุชุทุจูู", "ุตุญ/ุฎุทุฃ: ุงูุฏุงุฆุฑุฉ ุงูููุชูุญุฉ ุชุณูุญ ุจูุฑูุฑ ุงูุชูุงุฑ ูุซู ุงููุบููุฉ.", false,
        "ููุชุงุฒ โ", "ุงูุฏุงุฆุฑุฉ ุงูููุชูุญุฉ ุชููู ูุฑูุฑ ุงูุชูุงุฑ ๐"),
      shortQ("ุชุญููู", `ูุณูุฑู ุณุจุจ ุชููู ุงููุตุจุงุญ ุนู ุงูุฅุถุงุกุฉ ุนูุฏ ุงููุทุงุน ุณูู ูุงุญุฏ. (${lessonTitle})`,
        ["ุฏุงุฆุฑุฉ", "ูุณุงุฑ", "ูุบูู"],
        "ุฑุงุฆุน ๐ฏ", "ุงุฐูุฑู: ุงููุณุงุฑ ุบูุฑ ููุชูู/ุงูุฏุงุฆุฑุฉ ููุชูุญุฉ ๐"),
      shortQ("ุชูููู", "ููููู: ุฃูููุง ุฃูุซุฑ ุฃูุงููุง ูููุงุฐุงุ ููุณ ุณูู ููุดูู ุฃู ุงุณุชุนูุงู ุนุงุฒูุ",
        ["ุนุงุฒู", "ุณูุงูุฉ", "ููุดูู"],
        "ุฅุฌุงุจุฉ ูุงุนูุฉ โ๐", "ุงุฐูุฑู ุงูุณูุงูุฉ ุงูููุฑุจุงุฆูุฉ ูุงูุนุงุฒู ๐")
    ];
  }

  function bankMagnet(lessonTitle){
    return [
      mcq("ููู", `ุฃู ุงูููุงุฏ ุชูุฌุฐุจ ุนุงุฏุฉู ูููุบูุงุทูุณุ (${lessonTitle})`,
        ["ุงูุญุฏูุฏ", "ุงูุฎุดุจ", "ุงููุฑู", "ุงูุฒุฌุงุฌ"],
        0,
        "ุตุญูุญ โ๐งฒ", "ุฑุงุฌุนู ุงูููุงุฏ ุงููุบูุงุทูุณูุฉ ๐"),
      mcq("ุชุทุจูู", "ุนูุฏ ุชูุฑูุจ ูุทุจูู ูุชุดุงุจููู (ุดูุงู ูุน ุดูุงู) ูุญุฏุซ ุบุงูุจูุง:",
        ["ุชูุงูุฑ", "ุชุฌุงุฐุจ", "ุฐูุจุงู", "ุงููุณุงุฑ"],
        0,
        "ุฃุญุณูุชู โ", "ุชุฐูุฑู: ุงููุชุดุงุจู ูุชูุงูุฑ ๐"),
      tf("ููู", "ุตุญ/ุฎุทุฃ: ูููุบูุงุทูุณ ูุทุจุงู.", true,
        "ุตุญูุญ โ", "ุฑุงุฌุนู ููููู ุงูุฃูุทุงุจ ๐"),
      tf("ุชุทุจูู", "ุตุญ/ุฎุทุฃ: ูููู ูููุบูุงุทูุณ ุฌุฐุจ ุงูุจูุงุณุชูู ูุซู ุงูุญุฏูุฏ.", false,
        "ููุชุงุฒ โ", "ุงูุจูุงุณุชูู ูุง ููุฌุฐุจ ุนุงุฏุฉู ๐"),
      shortQ("ุชุญููู", `ูุณูุฑู ููุงุฐุง ุชูุณุชุฎุฏู ุงููุบูุงุทูุณุงุช ูู ูุตู ุจุนุถ ุงูููุงุฏ. (${lessonTitle})`,
        ["ูุตู", "ุฌุฐุจ", "ุญุฏูุฏ"],
        "ููุชุงุฒ ๐ฏ", "ุงุฐูุฑู ุงูุฌุฐุจ ููุญุฏูุฏ/ุงูููุฒุงุช ุงูููุงุณุจุฉ ๐"),
      shortQ("ุฅุจุฏุงุน", "ุงูุชุฑุญู ุชุฌุฑุจุฉ ุจุณูุทุฉ ูุงุฎุชุจุงุฑ ููุงุฏ ุชูุฌุฐุจ ูููุบูุงุทูุณ ูุน ุชุณุฌูู ุงููุชุงุฆุฌ.",
        ["ุชุฌุฑุจุฉ", "ููุงุฏ", "ูุชุงุฆุฌ", "ุฌุฏูู"],
        "ุฌููู ๐", "ุงุฐูุฑู ุฎุทูุงุช + ุฌุฏูู ูุชุงุฆุฌ ๐")
    ];
  }

  function bankMotionForces(lessonTitle){
    return [
      mcq("ููู", `ุงูููุฉ ูู: (${lessonTitle})`,
        ["ุฏูุน ุฃู ุณุญุจ", "ููุน ูู ุงูุถูุก", "ุญุงูุฉ ูู ุญุงูุงุช ุงููุงุฏุฉ", "ุตูุช ูุฑุชูุน"],
        0,
        "ุตุญูุญ โ๐ช", "ุงูููุฉ = ุฏูุน/ุณุญุจ ๐"),
      mcq("ุชุทุจูู", "ุฃู ูุซุงู ููุถุญ ุงูุงุญุชูุงูุ",
        ["ุชุจุงุทุค ุงูุฏุฑุงุฌุฉ ุนูุฏ ุงููุฑููุฉ", "ุงูุชูุงู ุงูุถูุก ูู ุงูููุงุก", "ุชูุงุซุฑ ุงููุจุงุช", "ุฏูุฑุงู ุงูููุฑ"],
        0,
        "ุฃุญุณูุชู โ", "ุงูุงุญุชูุงู ูููู ุงูุญุฑูุฉ ๐"),
      tf("ููู", "ุตุญ/ุฎุทุฃ: ุฒูุงุฏุฉ ุงูููุฉ ุบุงูุจูุง ุชุฒูุฏ ุชุบูุฑ ุญุฑูุฉ ุงูุฌุณู.", true,
        "ุตุญูุญ โ", "ุฑุงุฌุนู ุนูุงูุฉ ุงูููุฉ ุจุงูุญุฑูุฉ ๐"),
      tf("ุชุทุจูู", "ุตุญ/ุฎุทุฃ: ุงูุฌุณู ุงูุณุงูู ูุง ูููู ุชุญุฑููู ุจููุฉ.", false,
        "ููุชุงุฒ โ", "ุงูููุฉ ูุฏ ุชุบููุฑ ุงูุณููู ุฅูู ุญุฑูุฉ ๐"),
      shortQ("ุชุญููู", `ุญูููู: ููุงุฐุง ุชุชุบูุฑ ุณุฑุนุฉ ุฌุณู ุนูุฏ ุฒูุงุฏุฉ ุงูุงุญุชูุงูุ (${lessonTitle})`,
        ["ุงุญุชูุงู", "ุชุจุงุทุค", "ุญุฑูุฉ"],
        "ุฑุงุฆุน ๐ฏ", "ุงุฐูุฑู ุฃู ุงูุงุญุชูุงู ูุนุงูุณ ุงูุญุฑูุฉ ๐"),
      shortQ("ุชูููู", "ุงูุชุฑุญู ุทุฑููุฉ ูุฌุนู ุญุฑูุฉ ูุนุจุฉ ุณูุงุฑุฉ ุฃุณุฑุน ูุน ุชูููู ุงูุงุญุชูุงู.",
        ["ุณุทุญ", "ุฃููุณ", "ุฒูุช", "ุนุฌูุงุช"],
        "ูุจุฏุนุฉ ๐", "ุงุฐูุฑู ุชูููู ุงูุงุญุชูุงู ุจุณุทุญ ุฃููุณ/ุชุดุญูู ๐")
    ];
  }

  function bankMatterChanges(lessonTitle){
    return [
      mcq("ููู", `ุฃู ููุง ููู ูุนุฏ ุชุบูุฑูุง ููุฒูุงุฆููุง ุบุงูุจูุงุ (${lessonTitle})`,
        ["ุงูุตูุงุฑ ุงูุซูุฌ", "ุงุญุชุฑุงู ุงููุฑู", "ุตุฏุฃ ุงูุญุฏูุฏ", "ุทุจุฎ ุงูุจูุถุฉ"],
        0,
        "ุตุญูุญ โ๐ง", "ุงูุชุบูุฑ ุงูููุฒูุงุฆู ูุง ูููุชุฌ ูุงุฏุฉ ุฌุฏูุฏุฉ ๐"),
      mcq("ููู", "ุฃู ุญุงูุฉ ูู ุญุงูุงุช ุงููุงุฏุฉ ุชุฃุฎุฐ ุดูู ุงููุนุงุก ูุญุฌููุง ุซุงุจุชุ",
        ["ุงูุณุงุฆู", "ุงูุบุงุฒ", "ุงูุตูุจ", "ุงูุถูุก"],
        0,
        "ุฃุญุณูุชู โ", "ุงูุณุงุฆู: ุดูู ุงููุนุงุก ูุญุฌู ุซุงุจุช ๐"),
      tf("ุชุทุจูู", "ุตุญ/ุฎุทุฃ: ุงูุชุบูุฑ ุงูููููุงุฆู ููุชุฌ ูุงุฏุฉ ุฌุฏูุฏุฉ.", true,
        "ุตุญูุญ โ", "ุฑุงุฌุนู ุฃูุซูุฉ ุงูุงุญุชุฑุงู/ุงูุตุฏุฃ ๐"),
      tf("ููู", "ุตุญ/ุฎุทุฃ: ุงูุบุงุฒุงุช ููุง ุดูู ูุญุฌู ุซุงุจุชุงู.", false,
        "ููุชุงุฒ โ", "ุงูุบุงุฒ ูุชูุฏุฏ ููุฃุฎุฐ ุดูู ุงูููุงู ๐"),
      shortQ("ุชุญููู", `ูุณูุฑู ุงููุฑู ุจูู ุชุบูุฑ ููุฒูุงุฆู ูุชุบูุฑ ููููุงุฆู ุจูุซุงู. (${lessonTitle})`,
        ["ููุฒูุงุฆู", "ููููุงุฆู", "ูุงุฏุฉ ุฌุฏูุฏุฉ"],
        "ุฑุงุฆุน ๐ฏ", "ุงุฐูุฑู: ูุงุฏุฉ ุฌุฏูุฏุฉ/ูุง ูุงุฏุฉ ุฌุฏูุฏุฉ + ูุซุงู ๐"),
      shortQ("ุฅุจุฏุงุน", "ุตููู ุจุทุงูุฉ ุชุตููู: (ุตูุจ/ุณุงุฆู/ุบุงุฒ) ูุน 3 ุฃูุซูุฉ ููู ููุน.",
        ["ุตูุจ", "ุณุงุฆู", "ุบุงุฒ", "ุฃูุซูุฉ"],
        "ููุชุงุฒ ๐", "ุงุฐูุฑู 3 ุฃูุซูุฉ ูุงุถุญุฉ ููู ุญุงูุฉ ๐")
    ];
  }

  function bankWeatherWater(lessonTitle){
    return [
      mcq("ููู", `ุฃู ุนูุตุฑ ููุนุฏ ูู ุนูุงุตุฑ ุงูุทูุณุ (${lessonTitle})`,
        ["ุฏุฑุฌุฉ ุงูุญุฑุงุฑุฉ", "ุงููุบูุงุทูุณ", "ุฎูุงูุง ุงูุฏู", "ุงูุตุฎูุฑ"],
        0,
        "ุตุญูุญ โ๐ค๏ธ", "ุงูุทูุณ: ุญุฑุงุฑุฉ/ุฑูุงุญ/ูุทููโฆ ๐"),
      mcq("ุชุทุจูู", "ูู ุฏูุฑุฉ ุงููุงุก: ุชุญูู ุงููุงุก ูู ุณุงุฆู ุฅูู ุบุงุฒ ูุณูู:",
        ["ุชุจุฎุฑ", "ุชูุงุซู", "ุชุฌูุฏ", "ุงูุตูุงุฑ"],
        0,
        "ุฃุญุณูุชู โ", "ุชุจุฎุฑ = ุณุงุฆู ุฅูู ุบุงุฒ ๐"),
      tf("ููู", "ุตุญ/ุฎุทุฃ: ุงูุชูุงุซู ูุญุฏุซ ุนูุฏูุง ูุจุฑุฏ ุจุฎุงุฑ ุงููุงุก.", true,
        "ุตุญูุญ โ", "ุงูุชูุงุซู = ูุชุญูู ููุทูุฑุงุช ๐"),
      tf("ุชุทุจูู", "ุตุญ/ุฎุทุฃ: ุงูุบููู ุชุชููู ุบุงูุจูุง ูู ุจุฎุงุฑ ูุงุก ุบูุฑ ูุฑุฆู ููุท.", false,
        "ููุชุงุฒ โ", "ุงูุบููู ูุทูุฑุงุช ูุงุก/ุจููุฑุงุช ุซูุฌ ๐"),
      shortQ("ุชุญููู", `ูุณูุฑู ููู ุชุคุซุฑ ุฏุฑุฌุฉ ุงูุญุฑุงุฑุฉ ุนูู ุญุฏูุซ ุงููุทุฑ. (${lessonTitle})`,
        ["ุชุจุฎุฑ", "ุชูุงุซู", "ูุทูู"],
        "ุฑุงุฆุน ๐ฏ", "ุงุฐูุฑู: ุชุจุฎุฑ ุซู ุชูุงุซู ุซู ูุทูู ๐"),
      shortQ("ุชูููู", "ุงูุชุฑุญู ุณููููุง ูููู ูุฏุฑ ุงููุงุก ูู ุงููุฏุฑุณุฉ ูุนููู.",
        ["ุชุฑุดูุฏ", "ูุงุก", "ูุฏุฑ"],
        "ุฃุญุณูุชู โ๐", "ุงุฐูุฑู ุณููู + ุณุจุจ ๐")
    ];
  }

  function bankEcosystems(lessonTitle){
    return [
      mcq("ููู", `ูู ุงูุณูุณูุฉ ุงูุบุฐุงุฆูุฉุ ุงูููุชุฌ ูู ุบุงูุจูุง: (${lessonTitle})`,
        ["ุงููุจุงุช", "ุงูุฃุณุฏ", "ุงููุทุฑ", "ุงูุฅูุณุงู ููุท"],
        0,
        "ุตุญูุญ โ๐ฟ", "ุงูููุชุฌ ูุตูุน ุบุฐุงุกู ๐"),
      mcq("ุชุญููู", "ุฅุฐุง ูููุช ุฃุนุฏุงุฏ ุงูููุชุฑุณุงุชุ ูุงุฐุง ูุฏ ูุญุฏุซ ูุฃุนุฏุงุฏ ุงููุฑุงุฆุณุ",
        ["ุชุฒุฏุงุฏ ุบุงูุจูุง", "ุชุฎุชูู ุชูุงููุง", "ูุง ุชุชุบูุฑ ุฃุจุฏูุง", "ุชุชุญูู ููุจุงุชุงุช"],
        0,
        "ููุชุงุฒ โ", "ุงูุนูุงูุฉ ุชุคุซุฑ ุนูู ุงูุงุชุฒุงู ๐"),
      tf("ููู", "ุตุญ/ุฎุทุฃ: ุงูุชููู ูุณุงุนุฏ ุงููุงุฆู ุนูู ุงูุจูุงุก ูู ุจูุฆุชู.", true,
        "ุตุญูุญ โ", "ุงูุชููู = ุจูุงุก ๐"),
      tf("ุชุทุจูู", "ุตุญ/ุฎุทุฃ: ุฌููุน ุงููุงุฆูุงุช ุชุญุตู ุนูู ุงูุทุงูุฉ ูุจุงุดุฑุฉ ูู ุงูุดูุณ.", false,
        "ููุชุงุฒ โ", "ุงูุทุงูุฉ ุชูุชูู ุนุจุฑ ุบุฐุงุก/ุณูุงุณู ๐"),
      shortQ("ุชุญููู", `ุญูููู ุฃุซุฑ ุฅุฒุงูุฉ ูุจุงุชุงุช ูุซูุฑุฉ ูู ููุทูุฉ ุนูู ุงููุงุฆูุงุช ุงูุฃุฎุฑู. (${lessonTitle})`,
        ["ููุชุฌุงุช", "ุทุงูุฉ", "ุณูุณูุฉ"],
        "ุฑุงุฆุน ๐ฏ", "ุงุฐูุฑู ุชุฃุซูุฑูุง ุนูู ุงูุบุฐุงุก ูุงูุทุงูุฉ ๐"),
      shortQ("ุชูููู", "ุงูุชุฑุญู ุญููุง ูุญูุงูุฉ ููุฑุฏ ุทุจูุนู ูุฑูุจ ููู ูุนููู.",
        ["ุญูุงูุฉ", "ููุฑุฏ", "ุชููุซ"],
        "ุฃุญุณูุชู โ", "ุงุฐูุฑู ุญู + ุณุจุจ ูุงุถุญ ๐")
    ];
  }

  function bankCellsBody(lessonTitle){
    return [
      mcq("ููู", `ุงูุฎูุงูุง ูู: (${lessonTitle})`,
        ["ูุญุฏุงุช ุจูุงุก ุงููุฎูููุงุช ุงูุญูุฉ", "ูุฌุฑุงุช ุตุบูุฑุฉ", "ุตุฎูุฑ ุฏูููุฉ", "ููุน ูู ุงูุทูุณ"],
        0,
        "ุตุญูุญ โ๐งซ", "ุงูุฎูุงูุง ุฃุณุงุณ ุงูุจูุงุก ๐"),
      mcq("ููู", "ุฃู ููุง ููู ูุฏู ุนูู ุฃู ุดูุฆูุง ุญููุ",
        ["ูููู ููุชูุงุซุฑ", "ูุง ูุชุบูุฑ ุฃุจุฏูุง", "ูุง ูุญุชุงุฌ ุทุงูุฉ", "ูุง ูุณุชุฌูุจ"],
        0,
        "ุฃุญุณูุชู โ", "ุงูุญูุงุฉ ููุง ุฎุตุงุฆุต ๐"),
      tf("ููู", "ุตุญ/ุฎุทุฃ: ุจุนุถ ุงููุงุฆูุงุช ุงูุญูุฉ ุชุชููู ูู ุฎููุฉ ูุงุญุฏุฉ.", true,
        "ุตุญูุญ โ", "ูุซู ุจุนุถ ุงููุงุฆูุงุช ุงูุฏูููุฉ ๐"),
      tf("ุชุทุจูู", "ุตุญ/ุฎุทุฃ: ุฃุฌูุฒุฉ ุงูุฌุณู ุชุนูู ูููุตูุฉ ููุง ุชุคุซุฑ ุจุจุนุถูุง.", false,
        "ููุชุงุฒ โ", "ุงูุฃุฌูุฒุฉ ูุชูุงููุฉ ๐"),
      shortQ("ุชุญููู", `ูุณูุฑู ููู ูุณุงุนุฏ ุฌูุงุฒ (ุงููุถู/ุงูุฏูุฑุงู/ุงูุชููุณ) ุงูุฌุณู ุนูู ุงูุญุตูู ุนูู ุงูุทุงูุฉ. (${lessonTitle})`,
        ["ุทุงูุฉ", "ุบุฐุงุก", "ุฃูุณุฌูู", "ููู"],
        "ุฑุงุฆุน ๐ฏ", "ุงุฐูุฑู ุงูุฏูุฑ ุจูุถูุญ (ูุงุฐุง ููุนู ุงูุฌูุงุฒุ) ๐"),
      shortQ("ุฅุจุฏุงุน", "ุตููู ูุฎุทุทูุง ุจุณูุทูุง ููุถุญ ุงูุชูุงู ุงูุบุฐุงุก/ุงูุฃูุณุฌูู ุฏุงุฎู ุงูุฌุณู.",
        ["ูุฎุทุท", "ุงูุชูุงู", "ุฏู", "ุฃูุณุฌูู"],
        "ูุจุฏุนุฉ ๐", "ุงุฐูุฑู ูุณุงุฑูุง ุจุณูุทูุง ุจุฎุทูุงุช ๐")
    ];
  }

  // ููุถูุน ุนุงู (ูู ุญุงู ูู ูุทุงุจู)
  function bankGeneric(lessonTitle){
    return [
      mcq("ููู", `ูุง ุงูููุฑุฉ ุงูุฑุฆูุณุฉ ูู ุฏุฑุณ (${lessonTitle})ุ`,
        ["ููุฑุฉ ุตุญูุญุฉ (ุนุฏููููุง)", "ูุดุชุช 1", "ูุดุชุช 2", "ูุดุชุช 3"], 0),
      mcq("ุชุทุจูู", `ุฃู ูุซุงู ููุถุญ ููููููุง ูู ุฏุฑุณ (${lessonTitle})ุ`,
        ["ูุซุงู ุตุญูุญ (ุนุฏููู)", "ูุดุชุช 1", "ูุดุชุช 2", "ูุดุชุช 3"], 0),
      tf("ููู", `ุตุญ/ุฎุทุฃ: ุนุจุงุฑุฉ ุนุงูุฉ ูุฑุชุจุทุฉ ุจุฏุฑุณ (${lessonTitle}) (ุนุฏููููุง).`, true),
      tf("ุชุทุจูู", `ุตุญ/ุฎุทุฃ: ุณุจุจ/ูุชูุฌุฉ ูุญุชููุฉ ูู ุฏุฑุณ (${lessonTitle}) (ุนุฏููููุง).`, false),
      shortQ("ุชุญููู", `ูุณูุฑู ุณุจุจ/ูุชูุฌุฉ ูุฑุชุจุทุฉ ุจุฏุฑุณ (${lessonTitle}).`, []),
      shortQ("ุฅุจุฏุงุน", `ุงุจุชูุฑู ูุดุงุทูุง/ูููุฐุฌูุง ุจุณูุทูุง ูุดุฑุญ ููุฑุฉ ูู ุฏุฑุณ (${lessonTitle}).`, [])
    ];
  }

  // ======= ุงุฎุชูุงุฑ ุงูุจูู ุญุณุจ ุนููุงู ุงูุฏุฑุณ =======
  function pickBank(lessonTitle){
    const t = lessonTitle;

    // ูุถุงุก
    if(hasAny(t, ["ููุฑ","ุงููุฌูู","ุงููุฌุฑุงุช","ุงููุธุงู ุงูุดูุณู","ุงูุงุฑุถ ูุงูุดูุณ","ูุณูู","ุฎุณูู","ุงุทูุงุฑ","ููู","ููุงุฑ","ูุตูู"])) {
      return bankSpace(t);
    }

    // ููุฑุจุงุก
    if(hasAny(t, ["ููุฑุจุงุก","ุงูุฏุงุฆุฑู","ุงูุฏุงุฆุฑุฉ","ูุตุจุงุญ","ุชูุงุฑ","ููุชุงุญ"])) {
      return bankElectricity(t);
    }

    // ูุบูุงุทูุณูุฉ
    if(hasAny(t, ["ูุบูุงุทูุณ","ูุบูุงุทูุณูู","ูุทุจ","ุงูุทุงุจ"])) {
      return bankMagnet(t);
    }

    // ุญุฑูุฉ/ููู/ุดุบู/ุขูุงุช
    if(hasAny(t, ["ุญุฑูู","ุงูุญุฑูุฉ","ููู","ููุฉ","ุงุญุชูุงู","ุงูุดุบู","ุงูุงุช","ุงูุขูุงุช","ุงูุณุฑุนู","ุงูุณุฑุนุฉ"])) {
      return bankMotionForces(t);
    }

    // ูุงุฏุฉ/ุชุบูุฑุงุช/ุญุงูุงุช/ูุฎุงููุท/ุนูุงุตุฑ
    if(hasAny(t, ["ูุงุฏู","ุงููุงุฏุฉ","ุญุงูุงุช","ุตูุจ","ุณุงุฆู","ุบุงุฒ","ูุฎุงููุท","ุงููุฎุงููุท","ุนูุงุตุฑ","ููุฒุงุช","ูุงููุฒุงุช","ุชุบูุฑุงุช","ููุฒูุงุฆูู","ููููุงุฆูู","ุงูุตูุงุฑ","ุชุจุฎุฑ","ุชูุงุซู"])) {
      return bankMatterChanges(t);
    }

    // ุทูุณ/ููุงุฎ/ุฏูุฑุฉ ุงููุงุก
    if(hasAny(t, ["ุทูุณ","ููุงุฎ","ุบููู","ูุทูู","ุนูุงุตู","ุฏูุฑุฉ ุงููุงุก","ุงููุงุก"])) {
      return bankWeatherWater(t);
    }

    // ุฃูุธูุฉ ุจูุฆูุฉ/ุณูุงุณู ุบุฐุงุฆูุฉ/ุชููู/ููุงุฑุฏ
    if(hasAny(t, ["ูุธุงู ุจูุฆู","ุงูุงูุธูุฉ ุงูุจูุฆูุฉ","ุณูุงุณู","ุดุจูุงุช ุบุฐุงุฆูู","ูุฑู ุงูุทุงูุฉ","ุชููู","ุงูุชููู","ููุงุฑุฏ","ุญูุงูุฉ ุงูููุงุฑุฏ","ุงูุชุฑุจู","ุงูุชุฑุจุฉ"])) {
      return bankEcosystems(t);
    }

    // ุฎูุงูุง/ุฃุฌูุฒุฉ/ุนูููุงุช ุญูุงุฉ
    if(hasAny(t, ["ุฎูุงูุง","ุงูุฎููุฉ","ุงููุณุงู","ูุฑุงุซู","ุงููุฑุงุซุฉ","ุงููุถู","ุชููุณ","ุงูุฏูุฑุงู","ุงุฎุฑุงุฌ","ุงูุฅุฎุฑุงุฌ","ุงุญุณุงุณ","ุงูุญุฑูุฉ ูุงูุฅุญุณุงุณ","ูุฎูููุงุช ุฏูููู"])) {
      return bankCellsBody(t);
    }

    return bankGeneric(t);
  }

  function makeLessonQuiz(gradeNum, lessonTitle){
    const questions = pickBank(lessonTitle).map(q => ({
      ...q,
      // ุฃุถู ุฑูุฒ ุงูููุงุฑุฉ ุชููุงุฆููุง ูู ููุงูุฉ ุงูุณุคุงู (ุงุฎุชูุงุฑู)
      prompt: q.prompt
    }));

    return {
      title: `๐ ุงูุชูููู ุงูุฎุชุงูู ุงูุฅููุชุฑููู โ (${lessonTitle})`,
      intro: "ุฃุฌูุจู ุนู ุงูุฃุณุฆูุฉุ ูุณุชุธูุฑ ูู ุงูุชุบุฐูุฉ ุงูุฑุงุฌุนุฉ ูุจุงุดุฑุฉ ๐",
      settings: { shuffleQuestions:false, showScore:true, passPercent:60 },
      questions,
      rubric: {
        excellent: "๐ฏ ููุชุงุฒ: ููู ุนููู ูุชุทุจูู ุตุญูุญ",
        good: "๐ ุฌูุฏ: ุฃุฎุทุงุก ุจุณูุทุฉ",
        needsSupport: "๐ก ูุญุชุงุฌ ุฏุนู: ุฑุงุฌุนู ุงูููุงููู ุงูุฃุณุงุณูุฉ"
      }
    };
  }

  return { makeLessonQuiz, skillEmoji };
})();
